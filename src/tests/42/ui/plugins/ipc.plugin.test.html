<!DOCTYPE html>
<meta charset="utf-8" />
<title>ipc.plugin</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<script type="module">
  import ui from "../../../../42/ui.js"

  const app = await ui(
    {
      tag: "body.box-fit.desktop",
      content: [
        {
          tag: "button#incr",
          content: "{{cnt}}",
          click: "{{cnt += 1}}",
        },

        {
          tag: "button#dialog",
          content: "dialog",
          dialog: {
            y: 200,
            label: "top ({{x}},{{y}})",
            content: {
              tag: "button#dialog-incr",
              content: "{{cnt}}",
              click: "{{cnt += 1}}",
            },
          },
        },

        {
          content: {
            tag: "ui-sandbox",
            permissions: "trusted",
            content: [
              {
                tag: "button#iframe-incr",
                content: "{{cnt}}",
                click: "{{cnt += 1}}",
              },
              {
                tag: "button#iframe-dialog",
                content: "dialog",
                dialog: {
                  y: 300,
                  label: "iframe ({{x}},{{y}})",
                  content: {
                    tag: "button#iframe-dialog-incr",
                    content: "{{cnt}}",
                    click: "{{cnt += 1}}",
                  },
                },
              },
            ],
            // script: `app.query("button#iframe-dialog")?.click()`,
            script: `
            app.query("button#iframe-incr")?.click()
            // app.query("button#iframe-incr")?.click()
          `,
          },
        },
      ],

      state: {
        cnt: 42,
      },
    },
    { trusted: true }
  )

  globalThis.app = app

  // app.query("button#dialog")?.click()
  // app.query("button#incr")?.click()
</script>
