<!DOCTYPE html>
<meta charset="utf-8" />
<title>transferable</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<!-- <script type="module">
  import trap from "../../../42/fabric/type/error/trap.js"
  trap()
</script> -->

<style>
  .demos {
    width: 100%;
  }
  .demo {
    width: 100%;
    max-width: 450px;
    min-width: 450px;
  }

  .demo-xy {
    height: calc(18 * var(--unit));
  }
</style>

<body class="box-center desktop pa">
  <div class="demos"></div>
</body>

<script type="module">
  const { outerHTML } = document.documentElement
  function makeDocClone(color1, color2) {
    const iframe = document.createElement("iframe")
    iframe.className = "inset paper size-full"

    iframe.srcdoc = outerHTML
      .replaceAll('id="', 'id="iframe-')
      .replaceAll("green", color1)
      .replaceAll("yellow", color2)
      .replaceAll("box-center desktop", "box-center ground")
      .replace(/<!-{2} \[42] -{2}>[^\n]+/, "")

    document.body.append(iframe)
  }

  if (window.top === window.self) {
    // makeDocClone("blue", "red")
    makeDocClone("indigo", "purple")
    document.body.classList.add("box-h", "box-fit", "gap")

    // const iframe = document.createElement("iframe")
    // iframe.className = "inset"
    // iframe.srcdoc = "empty iframe"
    // document.querySelector(".demos").append(iframe)
  }
</script>

<script type="module">
  import ui from "../../../42/ui.js"
  import "../../../42/ui/components/tabs.js"
  import planets from "../../../tests/fixtures/data/planets.js"

  const state = {
    planets: [],
  }
  for (const item of planets) {
    state.planets.push({
      label: item.name,
      description: item.description,
      content: {
        tag: "textarea.w-full",
        bind: "description",
        compact: true,
        autofocus: true,
        rows: 3,
      },
    })
  }

  function makeArray(length, prefix = "") {
    return Array.from({ length }).map((_, i) => prefix + (i + 1))
  }

  state.listA = makeArray(4)
  state.listB = makeArray(7, "1")

  ui(".demos", {
    plugins: ["markdown"],
    state,
    content: [
      "# Transferable",
      {
        tag: ".demo.demo-small.scroll-x-auto.d-flex.pa-xl.gap-xl.inset paper",
        transferable: {
          dropzoneConfig: "fade",
        },
        content: makeArray(4).map((content) => ({
          tag: "span.bd.pa-xl.font-mono.bg-opacity-50.bg-green-200",
          content,
        })),
      },
      {
        tag: ".demo.demo-small.scroll-x-auto.d-flex.pa-xl.gap-xl.inset paper",
        selectable: true,
        transferable: {
          dropzoneConfig: "fade",
        },
        content: makeArray(4, "1").map((content) => ({
          tag: "span.bd.pa-xl.font-mono.bg-opacity-50.bg-green-400",
          content,
        })),
      },

      "## list",
      {
        scope: "listA",
        tag: ".demo.demo-small.scroll-x-auto.d-flex.pa-xl.gap-xl.inset paper",
        aria: { orientation: "horizontal" },
        transferable: {
          list: "{{.}}",
        },
        each: {
          tag: "span.bd.pa-xl.font-mono.bg-opacity-50.bg-gray-200",
          content: "{{.}}",
        },
      },
      {
        scope: "listB",
        tag: ".demo.demo-small.scroll-x-auto.d-flex.pa-xl._gap-xl.inset paper",
        aria: { orientation: "horizontal" },
        selectable: {
          selection: ["12", "14", "16"],
        },
        transferable: {
          list: "{{.}}",
        },
        each: {
          tag: "span.bd.pa-xl.font-mono.bg-opacity-50.bg-pink-200",
          content: "{{.}}",
        },
      },

      // "## layout",
      // {
      //   tag: "ui-tabs",
      //   id: "tabs1",
      //   // style: { height: "100px" },
      //   items: "{{planets}}",
      // },
    ],
  })
</script>
