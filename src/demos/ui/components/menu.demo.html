<!DOCTYPE html>
<meta charset="utf-8" />
<title>ui-menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<script type="module">
  import trap from "../../../42/fabric/type/error/trap.js"
  trap()
</script>

<script type="module">
  /*  eslint-disable no-unused-vars  */
  import "../../../42/ui/components/dialog.js"
  import "../../../42/ui/popup.js"
  import ui from "../../../42/ui.js"
  import inTop from "../../../42/core/env/realm/inTop.js"

  const content = [
    {
      label: "Open",
      id: "btnOpen",
      picto: "folder-open",
      shortcut: "Ctrl+O",
      dialog: {
        label: "Open File",
        content: { tag: "input", placeholder: "path" },
      },
    },
    {
      label: "Save",
      picto: "save",
      shortcut: "Ctrl+S",
      click: "{{save()}}",
      disabled: true,
    },
    "---",
    { label: "Ping", click: "{{ping(42)}}" },
  ]

  const demo = {
    tag: ".pa-xxl",
    content: [
      { tag: "input", placeholder: "tab order" },
      "---",
      { tag: "ui-menu", content },
      "---",
      { tag: "button#btnMenu", content: "Menu", menu: content },
    ],

    actions: {
      open() {
        console.log("open", /* this,  */ inTop)
      },
      save() {
        console.log("save", /* this,  */ inTop)
      },
      ping(n) {
        console.log("ping", n, /* this,  */ inTop)
        return n + 1
      },
    },
  }

  let app

  if (inTop) {
    app = await ui(
      {
        tag: ".box-fit.desktop",
        content: {
          tag: ".box-v.w-full",
          content: [
            demo,
            {
              tag: "ui-sandbox.panel",
              permissions: "trusted",
              path: "./menu.demo.html",
            },
          ],
        },
      },
      { trusted: true }
    )
    // app.query("#btnMenu").click()
  } else {
    app = await ui(demo)
    // app.query("#btnOpen").click()
    app.query("#btnMenu").click()
  }
</script>
