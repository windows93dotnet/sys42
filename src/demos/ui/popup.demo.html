<!DOCTYPE html>
<meta charset="utf-8" />
<title>popup</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<script type="module">
  import trap from "../../42/fabric/type/error/trap.js"
  trap()
</script>

<script type="module">
  import ui from "../../42/ui.js"

  const button = {
    tag: "button#incr",
    content: "{{cnt}}",
    click: "{{cnt += 1}}",
  }

  const buttons = (label) => ({
    tag: ".box-h",
    content: [
      button,
      {
        tag: `button#dialog-${label}`,
        content: "dialog",
        dialog: {
          x:
            label === "top"
              ? window.innerWidth / 2 - 200
              : window.innerWidth / 2 + 50,
          label,
          content: button,
        },
      },
      {
        tag: "button#popup",
        content: "popup",
        popup: {
          tag: ".panel.outset.pa-xxl",
          content: `hello from ${label}`,
        },
      },
    ],
  })

  // eslint-disable-next-line no-unused-vars
  const app = await ui(
    {
      tag: ".box-fit.box-center",
      content: {
        tag: ".box-v.w-full",
        content: [
          {
            tag: ".box-center.ground",
            content: buttons("top"),
          },
          {
            tag: "ui-sandbox",
            permissions: "app",
            content: {
              tag: ".box-fit.box-center.desktop",
              content: buttons("iframe"),
            },
            // script: `setTimeout(() => app.query("#dialog-iframe")?.click(), 500)`,
            script: `app.query("#popup").click()`,
          },
        ],
      },
      state: {
        cnt: 42,
      },
    },
    { id: "popup-demo" }
  )

  // setTimeout(() => app.query("#dialog-top")?.click(), 500)
  // app.query("#popup").click()
</script>
