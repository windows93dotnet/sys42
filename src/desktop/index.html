<!DOCTYPE html>
<meta charset="utf-8" />
<title>desktop</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<!-- <script type="module">
  import realm from "../42/system/realm.js"

  console.log(await realm())
</script> -->

<script type="module">
  import "../42/os.js"
  import "../42/ui/components/enclose.js"
  import ui from "../42/ui.js"
  import explorer from "../42/ui/components/explorer.js"

  // navigator.serviceWorker?.register("/42.sw.js", { type: "module" })

  window.app = ui.trusted({
    type: "body.box-fit.box-h.desktop._debug",
    content: [
      {
        // type: "header.box-stack",
        type: ".box-stack",
        content: [
          {
            type: "ui-folderview.scroll-auto",
            shortcuts: [
              // {
              //   key: "[click]",
              //   selector: "ui-icon",
              //   run: "iconFocus",
              //   args: ["target.path"],
              // },
              // {
              //   key: "ctrl+[click]",
              //   selector: "ui-icon",
              //   run: "iconSelect",
              //   args: ["target.path"],
              // },
              {
                key: "[dblclick]",
                selector: 'ui-icon[aria-description="folder"]',
                run: "folderOpen",
                args: ["target.path"],
              },
            ],
          },
          // { type: "ui-workspaces" },
        ],
      },
      {
        type: "ui-enclose.ma-xxl.bd",
        permissions: "app",
        // permissions: "trusted",
        // permissions: ["scripts"],
        check: false,
        // src: "../demos/ui/components/menu.demo.html",
        // src: "../demos/ui/components/dialog.demo.html",
        src: "../42/os/apps/TextEdit/index.html",
        // src: "../demos/os/exec.demo.html",
        // src: "../demos/ui/traits/selectable.demo.html",
      },
      {
        type: "footer.outset",
        scope: "desktop",
        content: { type: "button", label: "{{hello}}", run: "start" },
      },
    ],

    data: {
      desktop: {
        hello: "hi",
      },
    },

    actions: {
      desktop: {
        start() {
          this.hello = "hello"
        },
      },
      folderOpen(path) {
        console.log(888)
        explorer(path)
      },
      // iconFocus(path) {
      //   console.log("iconFocus", path)
      // },
      // iconSelect(path) {
      //   console.log("iconSelect", path)
      // },
      // removeSelection() {
      //   console.log("removeSelection")
      // },
    },
  })

  // explorer("/42/")
  // explorer("/42/../ui.js")
  // explorer("/42/../style.css")
  // explorer("/42/fabric/../ui.js")
</script>
