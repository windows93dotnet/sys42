<!DOCTYPE html>
<meta charset="utf-8" />
<title>desktop</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<script type="module">
  import trap from "../42/fabric/type/error/trap.js"
  trap()
</script>

<script type="_module">
  import ui from "../42/ui.js"
  import Component from "../42/ui/class/Component.js"

  Component.define(
    class Voila extends Component {
      static definition = {
        tag: "ui-voila",
        content: "hello {{lol(5)}}",
        props: {
          a: {
            type: "string",
            default: "yo",
          },
        },

        computed: {
          items: 1,
        },

        on: {
          click: "{{foo(a)}}",
        },
      }

      lol(arg) {
        return "lol" + arg
      }

      foo(e) {
        console.log(777, e)
      }
    }
  )

  ui({
    tag: "body.pa-xxl",
    content: {
      tag: "ui-voila",
    },

    state: {
      a: "lol",
    },
  })
</script>

<script type="module">
  import "../42/os.js"
  import explorer from "../42/ui/components/explorer.js"
  // import puppet from "../42/core/dev/puppet.js"
  explorer("/tests/fixtures/formats/example.url")
  // explorer("/tests/fixtures/formats/", {
  //   selection: [
  //     "/tests/fixtures/formats/example.url",
  //     "/tests/fixtures/formats/example.xml",
  //   ],
  // })

  // await puppet(
  //   'ui-icon[path="/tests/fixtures/formats/example.xml"]'
  // ).contextmenu()
</script>

<script type="_module">
  import "../42/os.js"
  import ui from "../42/ui.js"
  import explorer from "../42/ui/components/explorer.js"
  import open from "../42/os/cmd/open.cmd.js"

  await ui({
    tag: "body.box-fit.box-h._debug",
    content: [
      {
        tag: "main#desktop.desktop",
        on: [
          {
            "selector": 'ui-icon[aria-description="folder"]',
            "dblclick || Enter || Space": "{{openFolder(target.path)}}",
          },
          {
            "selector": 'ui-icon[aria-description="file"]',
            "dblclick || Enter || Space": "{{openFile(target.path)}}",
          },
        ],
        content: [
          {
            tag: "ui-folder.box-fit.scroll-auto",
          },
        ],
      },
      {
        scope: "taskbar",
        tag: "footer#taskbar.outset.pa-xs",
        content: {
          tag: "button",
          content: "Start",
          picto: "puzzle",
          menu: [{ label: "start" }],
        },
      },
    ],

    actions: {
      openFolder(path) {
        explorer(path)
      },
      openFile(path) {
        open(path)
      },
      taskbar: {
        start(e, target) {
          console.log("start", e, target)
        },
      },
    },
  })

  explorer("/42/fabric/")

  // import puppet from "../42/core/dev/puppet.js"
  // await puppet.when("uidialogopen")
  // await puppet('ui-icon[path="/42/fabric/constants/"]').dblclick()

  // await puppet('ui-icon[path="/42/"]').dblclick().when("uidialogopen")
  // await puppet('ui-icon[path="/42/os.js"]').dblclick()

  // await puppet('ui-icon[path="/files.json"]').dblclick()

  // if (globalThis.top === globalThis) open("/desktop/index.html")
  // else await puppet('ui-icon[path="/style.css"]').dblclick()
</script>
