<!DOCTYPE html>
<meta charset="utf-8" />
<title>42</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<style>
  @import "./42/themes/default/fonts/tomo.css";
  a,
  pre {
    font-family: tomo-web, monospace;
    font-size: calc(8px * 1);
    text-decoration: none;
    color: #0ff;
  }
  pre {
    line-height: 1.5;
    font-size: calc(8px * 1);
    width: min-content;
    height: min-content;
    display: block;
    margin: 0;
    overflow: hidden;
  }
  body {
    background-color: #000 !important;
    color: #0ff !important;
    overflow: hidden;
  }
  main {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    pointer-events: none;
  }
  main a {
    pointer-events: auto;
    margin-bottom: 0.8rem;
  }
  main div a {
    display: block;
  }
  main div a:hover {
    color: #fff;
  }
</style>

<main>
  <a href="/desktop/">
    <pre>
╷ ┌───┐
└─┤ ┌─┘
  └─┴─╴</pre
    >
  </a>
</main>

<script type="module">
  import system from "./42/system.js"
  import testRunner from "./42/core/dev/testRunner.js"
  import fs from "./42/core/fs.js"
  import disk from "./42/core/disk.js"
  import create from "./42/ui/create.js"

  system.DEV = true

  const main = document.querySelector("main")
  const div = create("div")
  main.append(div)
  const CLEAN_REG = /^\/demos\/|(\.plugin)?\.demo\.html$/g

  disk.glob("**/*.demo.html").forEach((href) => {
    div.append(create("a", href.replace(CLEAN_REG, ""), { href }))
  })

  // await disk.reinstall()
  await fs.deleteDir(system.HOME + "/.ui").catch(() => {})

  // console.log(disk.glob("**/*.test.js"))

  testRunner(
    // disk.glob("**/*.test.js"),
    [
      // "/tests/42/core/configure.test.js",
      // "/tests/42/core/console/formats/highlight.test.js",
      // "/tests/42/core/console/parseLogTemplate.test.js",
      // // "/tests/42/core/db/Database.test.js",
      // "/tests/42/core/dev/puppet.test.js",
      "/tests/42/core/expr.test.js",
      // "/tests/42/core/formats/base64.test.js",
      // "/tests/42/core/formats/cbor.test.js",
      // // "/tests/42/core/formats/ieee754.test.js",
      // // "/tests/42/core/formats/tar.test.js",
      "/tests/42/core/formats/template.test.js",
      "/tests/42/core/formats/template/parseExpression.test.js",
      // "/tests/42/core/fs.test.js",
      // "/tests/42/core/i18n.test.js",
      // // "/tests/42/core/ipc.test.js",
      // "/tests/42/core/log.test.js",
      // "/tests/42/core/path/core/sortPath.test.js",
      // "/tests/42/core/path/getPathInfos.test.js",
      // "/tests/42/core/path/glob.test.js",
      // "/tests/42/core/path/rename.test.js",
      // "/tests/42/core/path/shortenFilename.test.js",
      // // "/tests/42/core/stream.test.js",
      // // "/tests/42/fabric/classes/Buffer.compat.test.js",
      // // "/tests/42/fabric/classes/Buffer.test.js",
      // "/tests/42/fabric/dom/on.test.js",
      // "/tests/42/fabric/event/listen.test.js",
      // "/tests/42/fabric/traits/chainable.test.js",
      // "/tests/42/fabric/traits/emittable.test.js",
      // "/tests/42/fabric/type/any/clone.test.js",
      // "/tests/42/fabric/type/any/equal.test.js",
      // "/tests/42/fabric/type/any/hash.test.js",
      // "/tests/42/fabric/type/any/mark.test.js",
      // "/tests/42/fabric/type/any/stringify.test.js",
      // "/tests/42/fabric/type/file/bytesize.test.js",
      // "/tests/42/fabric/type/file/checksum.test.js",
      // "/tests/42/fabric/type/json/patch.test.js",
      // "/tests/42/fabric/type/number/isMultipleOf.test.js",
      // "/tests/42/fabric/type/number/precision.test.js",
      // "/tests/42/fabric/type/string/count.test.js",
      // "/tests/42/fabric/type/string/occurrences.test.js",
      // "/tests/42/fabric/type/string/sdbm.test.js",
      // "/tests/42/fabric/type/string/textPosition.test.js",
      // "/tests/42/os/cli/argv.test.js",

      "/tests/42/ui.test.js",
      "/tests/42/ui/components.test.js",
      "/tests/42/ui/components.actions.test.js",
      "/tests/42/ui/components/folder.test.js",
      "/tests/42/ui/components/icon.test.js",
      "/tests/42/ui/components/menu.test.js",
      // "/tests/42/ui/components/picto.test.js",
      // "/tests/42/ui/components/sandbox.test.js",
      "/tests/42/ui/create.test.js",
      "/tests/42/ui/filters.test.js",
      "/tests/42/ui/invocables/filePicker.test.js",
      "/tests/42/ui/invocables/modals.test.js",
      // "/tests/42/ui/invocables/progress.test.js",
      // "/tests/42/ui/plugins/ipc.plugin.test.js",
      // "/tests/42/ui/popup.test.js",
      // "/tests/42/ui/xss.test.js",
    ],
    { verbose: 2, cnt: !true }
  )
</script>
