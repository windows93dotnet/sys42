<!DOCTYPE html>
<meta charset="utf-8" />
<title>42</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/style.css" id="theme" />

<style>
  @import "./42/themes/default/fonts/tomo.css";
  a,
  pre {
    font-family: tomo-web, monospace;
    font-size: calc(8px * 1);
    text-decoration: none;
    color: #0ff;
  }
  pre {
    line-height: 1.5;
    font-size: calc(8px * 1);
    width: min-content;
    height: min-content;
    display: block;
    margin: 0;
    overflow: hidden;
  }
  body {
    background-color: #000 !important;
    color: #0ff !important;
    overflow: hidden;
  }
  main {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    pointer-events: none;
  }
  main a {
    pointer-events: auto;
    margin-bottom: 0.8rem;
  }
</style>

<main>
  <a href="/desktop/">
    <pre>
╷ ┌───┐
└─┤ ┌─┘
  └─┴─╴</pre
    >
  </a>
</main>

<script type="module">
  import testRunner from "./42/core/dev/testRunner.js"
  import system from "./42/system.js"
  import fs from "./42/core/fs.js"
  import disk from "./42/core/fs/disk.js"
  import create from "./42/ui/create.js"
  import stemname from "./42/fabric/type/path/extract/stemname.js"

  const main = document.querySelector("main")
  disk.glob("**/*.demo.html").forEach((href) => {
    main.append(create("a", stemname(href).replace(".demo", ""), { href }))
  })

  // await disk.reinstall()
  await fs.deleteDir(disk.HOME + "/.ui").catch(() => {})

  system.DEV = true

  testRunner(
    // disk.glob("**/*.test.js"),
    // disk.glob("**/*.test.js").filter((x) => !x.endsWith("ipc.plugin.test.js")),
    [
      "/tests/42/core/configure.test.js",
      "/tests/42/core/console/formats/highlight.test.js",
      "/tests/42/core/console/parseLogTemplate.test.js",
      // "/tests/42/core/db/Database.test.js",
      "/tests/42/core/expr.test.js",
      // "/tests/42/core/formats/cbor.test.js",
      "/tests/42/core/formats/template.test.js",
      "/tests/42/core/formats/template/parseExpression.test.js",
      // "/tests/42/core/fs.test.js",
      "/tests/42/core/i18n.test.js",
      // "/tests/42/core/log.test.js",
      "/tests/42/fabric/traits/chainable.test.js",
      "/tests/42/fabric/traits/emittable.test.js",
      // "/tests/42/fabric/type/any/clone.test.js",
      "/tests/42/fabric/type/any/hash.test.js",
      "/tests/42/fabric/type/any/mark.test.js",
      "/tests/42/fabric/type/any/stringify.test.js",
      "/tests/42/fabric/type/file/bytesize.test.js",
      "/tests/42/fabric/type/file/checksum.test.js",
      "/tests/42/fabric/type/number/isMultipleOf.test.js",
      "/tests/42/fabric/type/number/precision.test.js",
      "/tests/42/fabric/type/path/core/sortPath.test.js",
      "/tests/42/fabric/type/path/glob.test.js",
      "/tests/42/fabric/type/path/rename.test.js",
      "/tests/42/fabric/type/path/shortenFilename.test.js",
      "/tests/42/fabric/type/string/count.test.js",
      "/tests/42/fabric/type/string/sdbm.test.js",
      "/tests/42/fabric/type/string/textPosition.test.js",
      "/tests/42/os/cli/argv.test.js",
      "/tests/42/ui.test.js",
      "/tests/42/ui/components.test.js",
      "/tests/42/ui/components/folder.test.js",
      "/tests/42/ui/components/icon.test.js",
      "/tests/42/ui/components/picto.test.js",
      "/tests/42/ui/components/sandbox.test.js",
      "/tests/42/ui/create.test.js",
      // "/tests/42/ui/plugins/ipc.plugin.test.js",
    ],
    { verbose: 2 }
  )
</script>
